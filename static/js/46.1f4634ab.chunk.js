"use strict";(self.webpackChunkmaufruits_webapp=self.webpackChunkmaufruits_webapp||[]).push([[46],{3600:function(e,s,n){var r=n(8820),t=n(9434),a=n(3886),i=(n(4386),n(184));s.Z=function(e){var s=e.id,n=e.name,c=e.imgPath,o=e.unitprice,d=e.unitMeasure,l=e.qty,u=e.grade,h=(0,t.I0)();return(0,i.jsxs)("div",{className:"item flex center-v spaceBetween",children:[(0,i.jsxs)("div",{className:"item-desc flex",children:[(0,i.jsx)("img",{className:"item-img",src:c,alt:n}),(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"bold-text",children:n}),(0,i.jsxs)("p",{children:["Grade ",u]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("span",{children:"Rs"}),o,(0,i.jsxs)("span",{children:["/",d]})]}),(0,i.jsxs)("p",{className:"item-amount green-text bold-text",children:[(0,i.jsx)("span",{children:"x"}),l]})]})]}),(0,i.jsxs)("div",{className:"item-price",children:[(0,i.jsx)(r.LHV,{onClick:function(){h((0,a.h2)(s))},className:"item-removeIcon"}),(0,i.jsxs)("p",{className:"green-text",children:[(0,i.jsx)("span",{children:"Rs"}),o*l]})]})]})}},1325:function(e,s,n){n.d(s,{Z:function(){return c}});var r=n(885),t=n(2791),a=n(6355),i=n(184),c=function(e){var s=(0,t.useState)(e.openNow),n=(0,r.Z)(s,2),c=n[0],o=n[1];return(0,i.jsxs)("div",{className:"dropdown",children:[(0,i.jsxs)("div",{onClick:function(){o(!c),e.onClick&&e.onClick()},className:"dropdown-title flex spaceBetween center-v",children:[(0,i.jsx)("p",{children:e.title}),c?(0,i.jsx)(a.s$2,{}):(0,i.jsx)(a.RiI,{})]}),(0,i.jsx)("ul",{style:{height:"".concat(c?e.height:"0")},className:"dropdown-options ".concat(c?"open":""),children:e.children})]})}},7409:function(e,s,n){n.d(s,{Z:function(){return t}});var r=n(184),t=function(e){return(0,r.jsx)("div",{className:"error-displayBox",children:(0,r.jsx)("p",{className:"center-text",children:e.msg})})}},5310:function(e,s,n){n.d(s,{Z:function(){return c}});var r=n(6355),t=n(3504),a=n(7513),i=n(184),c=function(e){var s=e.error;return(0,i.jsxs)("div",{className:"error-container",children:[(0,i.jsx)("div",{className:"icon",children:(0,i.jsx)(r.gJy,{className:"w-100 h-100"})}),(0,i.jsxs)("div",{className:"center-text",children:[(0,i.jsxs)("p",{className:"error-code bold-text m-top-20",children:["Error ",s.statusCode]}),(0,i.jsxs)("p",{className:"error-message m-top-10",children:[s.message,(0,i.jsx)("br",{}),"Please try again later"]})]}),(0,i.jsx)(t.rU,{to:"/",children:(0,i.jsx)(a.Z,{className:"m-top-20",light:!0,children:"Dismiss"})})]})}},1974:function(e,s,n){n(2791),n(3037);var r=n(184);s.Z=function(e){var s=e.placeholder,n=e.valid,t=void 0===n||n,a=e.type,i=void 0===a?"text":a,c=e.name,o=e.value,d=void 0===o?"":o,l=e.onChange,u=e.children;return(0,r.jsxs)("div",{className:"input-data input-data-input ".concat(t?"":"invalid"),children:[(0,r.jsx)("input",{type:i,name:c,defaultValue:d,placeholder:s,onChange:l,required:!0}),u]})}},599:function(e,s,n){n.d(s,{Z:function(){return o}});var r=n(2791),t=n(4164),a=n(184),i=function(e){return(0,a.jsx)("div",{onClick:e.onClick,className:"popUp-backdrop"})},c=document.getElementById("popUp-container"),o=function(e){return(0,a.jsxs)(r.Fragment,{children:[(0,t.createPortal)((0,a.jsx)(i,{onClick:e.popUpHandler}),c),(0,t.createPortal)((0,a.jsx)("div",{className:"popUp-content",children:e.children}),c)]})}},3062:function(e,s,n){n.d(s,{K:function(){return r}});var r="https://maufruits.up.railway.app/api"},2046:function(e,s,n){n.r(s),n.d(s,{default:function(){return B}});var r=n(1413),t=n(885),a=n(2791),i=n(8725),c=n(2121),o=n(2982),d=n(1325),l=n(1974),u=n(8524),h=n(184),m=function(e){var s=e.addr,n=e.addrHandler,r=e.addAddrHandler,t=e.loading,a=e.success;return(0,h.jsxs)("form",{onSubmit:r,className:"newaddr",children:[(0,h.jsx)(l.Z,{name:"addressLine",value:s.addressLine,placeholder:"Address",onChange:n}),(0,h.jsxs)("div",{className:"name-field flex spaceBetween",children:[(0,h.jsx)(l.Z,{name:"city",value:s.city,placeholder:"City",onChange:n}),(0,h.jsx)(l.Z,{name:"contactNumber",value:s.contactNumber,placeholder:"Contact Number",onChange:n})]}),(0,h.jsxs)("div",{children:[(0,h.jsxs)("div",{className:"flex center-v m-top-10",children:[(0,h.jsx)("button",{type:"submit",className:"btn",children:"Add address"}),t&&(0,h.jsx)(u.Z,{noBackground:!0})]}),a&&(0,h.jsx)("p",{children:"Address added successfully"})]})]})},p=n(3423),x=n(1470),j=n(9434),f=n(3600),v=n(7513),g=n(2868),y=n(7409),N=n(3062),k=function(e){var s=(0,j.v9)((function(e){return e.cart.items})),n=(0,j.v9)((function(e){return e.user})),i=(0,a.useState)(!1),c=(0,t.Z)(i,2),l=c[0],k=c[1],b=(0,a.useState)(!1),Z=(0,t.Z)(b,2),C=Z[0],F=Z[1],w=(0,a.useState)(!1),I=(0,t.Z)(w,2),S=I[0],B=I[1],P=(0,g.Z)(),A=P.loading,E=P.fetchData,O=(0,a.useState)(""),U=(0,t.Z)(O,2),M=U[0],T=U[1],D=(0,a.useState)(""),H=(0,t.Z)(D,2),R=H[0],q=H[1],V=(0,a.useState)({}),K=(0,t.Z)(V,2),z=K[0],L=K[1];(0,a.useEffect)((function(){q("")}),[n]);var G=function(s){var n=s.target,r=n.name,t=n.value;"address"===r?T(t):q(t);var a=e.checkoutFormInfo;a[r]=t,e.setCheckoutFormInfo(a)},Y=function(s){var n=s.target,t=n.value,a=n.name,i=z;i[a]=t,L(i),e.registeredUser||e.setCheckoutFormInfo((0,r.Z)((0,r.Z)({},e.checkoutFormInfo),{},{address:i}))},J=function(s){s.preventDefault(),E({url:"".concat(N.K,"/userAddress"),method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+n.auth.accessToken},body:{address:z}},(function(s){e.setExistingAddr([(0,r.Z)({addrId:s.insertId},z)].concat((0,o.Z)(e.existingAddr))),T(s.insertId),e.setCheckoutFormInfo((0,r.Z)((0,r.Z)({},e.checkoutFormInfo),{},{address:s.insertId})),B(!0)}))},_=0===e.existingAddr.length?(0,h.jsx)(m,{addr:z,addrHandler:Y,addAddrHandler:J,loading:A,success:S}):(0,h.jsxs)(a.Fragment,{children:[(0,h.jsx)(d.Z,{onClick:function(){return F(!C)},title:"Choose from existing addresses",height:"".concat(70*e.existingAddr.length,"px"),openNow:!1,children:(0,h.jsx)(p.Z,{value:M,"aria-labelledby":"existing address",name:"existing address",onChange:G,children:e.existingAddr.map((function(e,s){return(0,h.jsxs)(a.Fragment,{children:[(0,h.jsxs)("li",{className:"flex",children:[(0,h.jsx)(x.Z,{value:e.addrId,name:"address",inputProps:{"aria-label":"".concat(e.addrId)}}),(0,h.jsxs)("div",{children:[(0,h.jsxs)("p",{className:"addr bold-text",children:[e.addressLine,",",(0,h.jsx)("br",{})," ",e.city]}),(0,h.jsx)("p",{className:"contactNum bold-text",children:e.contactNumber})]})]}),(0,h.jsx)("hr",{})]},s)}))})}),!C&&(0,h.jsx)("p",{className:"new-address-billingForm",onClick:function(){k(!l)},children:"+ Add new address"}),l&&!C&&(0,h.jsx)("div",{className:"addNewAddrForm",children:(0,h.jsx)(m,{addr:z,addrHandler:Y,addAddrHandler:J,loading:A,success:S})})]});return(0,h.jsxs)("div",{className:"billingInfo-container ".concat(e.open?"open-shippingInfo":""),children:[e.loading&&(0,h.jsx)(u.Z,{}),!e.loading&&(0,h.jsxs)(a.Fragment,{children:[(0,h.jsxs)("div",{className:"flex info",children:[(0,h.jsxs)("section",{className:"shippingInfo",children:[e.shippingFormValidity&&(0,h.jsx)(y.Z,{msg:e.shippingFormValidity}),(0,h.jsx)("h2",{children:"Delivery address"}),_,(0,h.jsx)("h2",{className:"m-top-30",children:"Delivery method"}),(0,h.jsxs)("div",{className:"shipping-option",children:[(0,h.jsx)("p",{children:"Choose delivery method:"}),(0,h.jsx)("span",{children:"*Delivery price depends on city and total purchase"}),(0,h.jsxs)(p.Z,{value:R,"aria-labelledby":"delivery options",name:"delivery options",onChange:G,children:[(0,h.jsxs)("div",{className:"m-top-10 flex center-v",children:[(0,h.jsx)(x.Z,{name:"deliveryOption",value:"delivery",inputProps:{"aria-label":"MauFruits Delivery"}}),(0,h.jsxs)("p",{className:"shipping-option-name",children:["MauFruits Delivery ",(0,h.jsx)("span",{className:"cost",children:"Rs125~200"})]})]}),(0,h.jsxs)("div",{className:"flex center-v",children:[(0,h.jsx)(x.Z,{name:"deliveryOption",value:"pick up",inputProps:{"aria-label":"Pick Up"}}),(0,h.jsxs)("p",{className:"shipping-option-name",children:["In store pick up ",(0,h.jsx)("span",{className:"cost",children:"Rs0"})]})]})]})]})]}),(0,h.jsxs)("section",{className:"cartInfo",children:[(0,h.jsx)("h2",{children:"Basket Items"}),e.basketError.length>0?(0,h.jsx)("p",{className:"itemUnvailableMsg",children:"*Some items are unavailable. Please  update your basket"}):"",(0,h.jsx)("div",{className:"cartInfo-items",children:s.map((function(s,n){return(0,h.jsxs)(a.Fragment,{children:[e.availabilityHandler(s.id),(0,h.jsx)(f.Z,{id:s.id,name:s.name,imgPath:s.imgPath,unitprice:s.sellingPrice,unitMeasure:s.unitMeasure,qty:s.qty,grade:s.grade},n)]},n)}))})]})]}),(0,h.jsx)("div",{className:"flex center-h",children:(0,h.jsx)(v.Z,{className:"formBtn",onClick:function(){return e.onClick(2)},children:"Continue"})})]})]})},b=n(6856),Z=n(3886),C=function(){return(0,h.jsxs)("div",{className:"payment-option",children:[(0,h.jsx)("p",{children:"Bank transfer to our MCB account"}),(0,h.jsxs)("p",{children:["Bank account: ",(0,h.jsx)("span",{className:"bold-text",children:"0009876782847"})]}),(0,h.jsx)("p",{className:"bold-text",children:"Note: Please specify the order id in the description field when transfering money."})]})},F=function(e){var s=e.onClick,n=e.setBasketError,i=(0,j.v9)((function(e){return e})),c=i.cart,o=i.user,d=(0,j.I0)(),l=(0,g.Z)(),m=l.fetchData,f=l.loading,k=l.error,F=(0,a.useState)(""),w=(0,t.Z)(F,2),I=w[0],S=w[1],B=(0,a.useState)({}),P=(0,t.Z)(B,2),A=P[0],E=P[1],O=function(s){var n=s.target,r=n.name,t=n.value;S(t);var a=e.checkoutFormInfo;a[r]=t,e.setCheckoutFormInfo(a)};(0,a.useEffect)((function(){S(""),m({url:"".concat(N.K,"/checkout/placeOrder"),method:"POST",headers:{"content-type":"application/json",Authorization:"Bearer "+o.auth.accessToken},body:{deliveryOption:e.checkoutFormInfo.deliveryOption,cart:c.items.map((function(e){return{id:e.id,qty:e.qty}}))}},(function(e){e.error?(n(e.error),s(1)):E(e)}))}),[m,e.checkoutFormInfo.deliveryOption,c,n,s,o.auth.accessToken]);return(0,h.jsxs)("div",{className:"payment-page ".concat(e.open?"open-paymentOption":""),children:[(0,h.jsxs)("div",{className:"flex",children:[f&&(0,h.jsx)(u.Z,{msg:"Please do not close this window. We are processing your order"}),(0,h.jsxs)("div",{className:"payment-options",children:[k&&!f&&function(){if(k.shippingFormError){if("delivery"!==k.shippingFormError.errorField)return(0,h.jsx)(y.Z,{msg:k.shippingFormError.message});e.setShippingFormValidity(k.shippingFormError.message),s(1)}else e.setOrderUnsuccessful(!0)}(),(0,h.jsx)("h2",{children:"Payment Method"}),(0,h.jsxs)(p.Z,{value:I,"aria-labelledby":"payment-options",name:"payment-options",onChange:O,children:[(0,h.jsxs)("p",{className:"bold-text",children:[(0,h.jsx)(x.Z,{name:"paymentOption",value:"card",color:"success",onChange:O}),"Debit/Credit Card"]}),"card"===I&&(0,h.jsx)("div",{className:"payment-option",children:(0,h.jsx)("p",{children:"You will be redirected to a secure page for payment."})}),(0,h.jsxs)("p",{className:"bold-text",children:[(0,h.jsx)(x.Z,{name:"paymentOption",value:"bank transfer",color:"success",onChange:O})," Bank Transfer"]}),"bank transfer"===I&&(0,h.jsx)(C,{}),(0,h.jsxs)("p",{className:"bold-text",children:[(0,h.jsx)(x.Z,{name:"paymentOption",value:"on delivery",color:"success",onChange:O})," Pay on delivery"]}),"on delivery"===I&&(0,h.jsx)("div",{className:"payment-option",children:(0,h.jsx)("p",{children:"You will be able to pay by cash on delivery."})})]})]}),(0,h.jsx)("div",{className:"finalCart-summary bold-text",children:!f&&(0,h.jsxs)(a.Fragment,{children:[(0,h.jsx)("h2",{children:"Order summary"}),A.discount>0&&(0,h.jsxs)("div",{className:"congratMsg flex center-v m-top-10",children:[(0,h.jsx)(b.jsv,{className:"congratIcon"}),(0,h.jsx)("p",{children:A.discountMsg})]}),(0,h.jsxs)("div",{className:"orderSummary m-top-10",children:[(0,h.jsxs)("div",{className:"flex spaceBetween",children:[(0,h.jsx)("p",{children:"Basket Totals: "}),(0,h.jsxs)("p",{children:["Rs",A.basketTotal]})]}),(0,h.jsxs)("div",{className:"flex spaceBetween",children:[(0,h.jsx)("p",{children:"Delivery: "}),(0,h.jsxs)("p",{children:["Rs",A.shipping]})]}),(0,h.jsxs)("div",{className:"flex spaceBetween",children:[(0,h.jsx)("p",{children:"Discount: "}),(0,h.jsxs)("p",{children:["Rs",A.discount]})]}),(0,h.jsx)("hr",{}),(0,h.jsxs)("div",{className:"flex spaceBetween orderSummary-totalPrice",children:[(0,h.jsx)("p",{children:"Total Price: "}),(0,h.jsxs)("p",{children:["Rs",A.basketTotal+A.shipping-A.discount]})]})]}),(0,h.jsx)(v.Z,{onClick:function(){m({url:"".concat(N.K,"/checkout/payment"),method:"POST",headers:{"content-type":"application/json",Authorization:"Bearer "+o.auth.accessToken},body:(0,r.Z)({email:o.auth.email,cart:c.items},e.checkoutFormInfo)},(function(e){e.status&&(d((0,Z.UY)()),e.sessionUrl&&(window.location.href=e.sessionUrl),e.successUrl&&(window.location.href=e.successUrl))}))},width:!0,children:"Place order"})]})})]}),(0,h.jsx)("div",{className:"flex center-h center-v",children:(0,h.jsx)(v.Z,{className:"formBtn",onClick:function(){return e.onClick(1)},children:"Go back"})})]})},w=n(599),I=n(5310),S=n(6871),B=function(){var e=(0,j.I0)(),s=(0,j.v9)((function(e){return e})),n=s.user,o=s.cart,d=(0,a.useState)(1),l=(0,t.Z)(d,2),u=l[0],m=l[1],p=(0,a.useState)([]),x=(0,t.Z)(p,2),f=x[0],y=x[1],b=(0,a.useState)({registered:n.registered}),C=(0,t.Z)(b,2),B=C[0],P=C[1],A=(0,g.Z)(),E=A.loading,O=A.error,U=A.fetchData,M=(0,a.useState)([]),T=(0,t.Z)(M,2),D=T[0],H=T[1],R=(0,a.useState)(),q=(0,t.Z)(R,2),V=q[0],K=q[1],z=(0,a.useState)(null),L=(0,t.Z)(z,2),G=L[0],Y=L[1],J=(0,S.s0)();(0,a.useEffect)((function(){P({registered:n.registered}),m(1),n.registered&&U({url:"".concat(N.K,"/userAddress"),headers:{Authorization:"Bearer "+n.auth.accessToken}},(function(e){y(e)}))}),[U,n]);var _=function(e){J(e,{state:{redirectUrl:"/MauFruits/checkout"}})},W=function(s,n){D.length>1?H(D.map((function(e){return e.id!==s}))):H([]),e((0,Z.xu)({id:s,qty:n}))},$={onClick:m,loading:E,open:1===u,checkoutFormInfo:B,setCheckoutFormInfo:P,availabilityHandler:function(e){var s=D.find((function(s){return s.id===e}));if(s)return(0,h.jsxs)("div",{className:"unavailable-msg",children:[(0,h.jsx)("p",{children:s.errMsg}),(0,h.jsx)("button",{onClick:function(){return W(s.id,s.qty)},children:"Update Basket"})]})},basketError:D,shippingFormValidity:V,existingAddr:f,setExistingAddr:y};return(0,h.jsx)(a.Fragment,{children:0===o.totalItems?(0,h.jsx)(w.Z,{children:(0,h.jsxs)("div",{className:"noItem-popup",children:[(0,h.jsxs)("p",{children:["Basket is empty.",(0,h.jsx)("br",{}),"Please add item to your basket before checking out."]}),(0,h.jsx)(v.Z,{onClick:function(){return _("/MauFruits/market")},children:"Ok"})]})}):G?(0,h.jsx)(c.Z,{success:!G}):(0,h.jsx)("main",{children:n.registered?(0,h.jsxs)(a.Fragment,{children:[(0,h.jsx)(i.Z,{progressNum:u}),(0,h.jsx)("section",{className:"shippingForm",children:(0,h.jsx)("div",{className:"form-container flex",children:O?(0,h.jsx)(I.Z,{error:O}):(0,h.jsxs)(a.Fragment,{children:[(0,h.jsx)(k,(0,r.Z)({},$)),(0,h.jsx)(F,{onClick:m,checkoutFormInfo:B,setCheckoutFormInfo:P,setBasketError:H,setOrderUnsuccessful:Y,setShippingFormValidity:K,shippingFormValidity:V,open:2===u})]})})})]}):(0,h.jsx)(w.Z,{children:(0,h.jsxs)("div",{className:"checkout-popup",children:[(0,h.jsx)("h2",{className:"green-text center-text",children:"Create an account with MauFruits."}),(0,h.jsx)("h3",{className:"m-top-20",children:(0,h.jsx)("b",{children:"Please create an account before proceeding to checkout"})}),(0,h.jsx)("p",{className:"m-top-10",children:"Benefits of creating an account:"}),(0,h.jsx)("p",{children:" - Access to some exclusive deals"}),(0,h.jsx)("p",{children:" - No need to input existing details for checkout"}),(0,h.jsx)(v.Z,{onClick:function(){return _("/MauFruits/login")},width:!0,children:"Sign up"})]})})})})}},2868:function(e,s,n){var r=n(1413),t=n(5861),a=n(885),i=n(7757),c=n.n(i),o=n(2791);s.Z=function(){var e=(0,o.useState)(!1),s=(0,a.Z)(e,2),n=s[0],i=s[1],d=(0,o.useState)(null),l=(0,a.Z)(d,2),u=l[0],h=l[1],m=(0,o.useCallback)(function(){var e=(0,t.Z)(c().mark((function e(s,n){var t,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i(!0),h(null),e.prev=2,e.next=5,fetch(s.url,{method:s.method?s.method:"GET",headers:s.headers?s.headers:{},body:JSON.stringify(s.body)});case 5:return t=e.sent,e.next=8,t.json();case 8:if(a=e.sent,t.ok){e.next=12;break}throw h((0,r.Z)((0,r.Z)({},a),{},{statusCode:t.status})),new Error("Request failed!");case 12:n(a),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),h((function(e){return e||{message:"Something went wrong with our server. Please try again later",statusCode:500}}));case 18:i(!1);case 19:case"end":return e.stop()}}),e,null,[[2,15]])})));return function(s,n){return e.apply(this,arguments)}}(),[]);return{loading:n,setError:h,error:u,fetchData:m}}},4386:function(){},3037:function(){}}]);
//# sourceMappingURL=46.1f4634ab.chunk.js.map